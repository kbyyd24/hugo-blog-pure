---
title: JUnit 不好用？也许你可以试试这些测试工具
date: 2021-11-26T00:01:57+08:00
draft: true
tags:
  - JUnit
  - Spock
  - Spek
  - Kotest
  - 测试
---

在我们日常的 TDD 开发中，永远绕不过去的就是要编写测试。而对于一个 Java 程序员，JUnit 似乎是一个不二的选择。它的确是一个十分优秀的工具，在大多数情况下都能够帮助我们完成测试的工作。

但是在开发过程中，我发现 JUnit 并不总是那么好用。它在一些情况下需要耗费大量的精力才能编写完成。如果不注意测试代码的可读性的话，编写完成的测试代码有时就会变得像天书一样难懂。

# JUnit 不擅长的事情

## 清晰表达测试的目的

在使用 JUnit 时，清晰的表达测试意图并不是总能做到的事情。这主要体现在两个方面。

**如何命名测试方法**

第一个体现就是在使用 Java 编写测试时，采用什么样的命名风格来命名测试。是为了代码风格的统一而选择驼峰？还是为了更高的可读性选择下划线？（如果用 Kotlin 来编写测试就不会有这个问题 🐶 ）

**如何组织方法内的代码**

第二个体现就是 JUnit 对测试方法内部如何编写没有强制的规定。这就意味着我可以在测试里面任意地组织代码，比如在一个测试方法里面对一个方法调用多次并验证每一次的结果，或者把调用测试目录的逻辑和准备数据的逻辑以及验证逻辑混合到一起。
总之这样的结果就是测试方法内的代码组织方式千奇百怪，每当阅读别人编写的测试的时候，总是要花上好几分钟才能知道这些代码到底在干什么。

对于这个问题，我个人会选择使用注释来标注一下 `given` 、 `when` 、 `then`，并且给 IDEA 设置了 live template 方便插入它们。

## 又不是不能用的参数化测试

如果说不能清晰地表达测试意图这个问题还有一些 workaround 可以绕过去的话，JUnit 那仅仅是能用的参数化测试功能就没有什么好办法可以绕过去了。

JUnit 提供了各种 `Source` 注解来为参数化测试提供数据，但是这个功能实在是太弱了。

# 使用 Spock 作为测试框架

## 如何使用 Spock

## 特点

### 语义化的结构

### 简洁的断言

### 使用 data table 构造参数化测试

### 使用 Groovy 编写测试

### 与 IDE 的完美集成

### 其他高级功能

## 缺点

### 无法识别 Kotlin 的语法糖

### Groovy 语言的学习成本

# 使用 Spek 作为测试框架

## 如何使用 Spek

## 特点

### Specification 风格的测试

### Gherkin 风格的测试

### 与 Kotlin 的完美集成

### 与 IDE 的完美集成

## 缺点

### 难以与 JUnit 混合使用

# 使用 Kotest 作为测试框架

## 如何使用 Kotest

## 特点

### 丰富的测试风格支持

## 缺点

### 无法与 IDE 集成

# 总结

